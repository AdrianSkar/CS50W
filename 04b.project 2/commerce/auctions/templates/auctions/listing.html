{% extends "auctions/layout.html" %}
{% load static %}
<title>{% block title %}{{ listing.title }} | Commerce auctions{% endblock %}</title>
{% block body %}

{% comment %} <script type="text/javascript" src="{% static 'auctions/toggle.js' %}">
</script> {% endcomment %}
<div class="container">
{% if message %}
<div class="alert {{ alert_type }} alert-dismissible fade show" role="alert">
	{{ message }}
	<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
{% endif %}
	<h2>{{ listing.title }}</h2>
	<form action="{% url 'listing' listing.id %}" method="POST">
		{% csrf_token %}
		{% if listing.watched %}
		<button type="submit" name="watchlist" class="btn badge bg-success mb-2" id="watchlist">Remove
			from
			watchlist</button>
	{% else %}
	<button type="submit" name="watchlist" class="btn badge bg-secondary mb-2" id="watchlist">Add to
		watchlist</button><br>
	{% endif %}
</form>

	<div class="row mb-2">
		<img src="{{ listing.image_url }}" alt="{{ listing.title }}'s image" class="rounded col-6 listing_img">

		<div class="col-6">
			<p>{{ listing.desc }}</p>
			<p><b>Current price: </b>{{ last_bid|default:listing.start_bid }}</p>
			<p><span> {{ num_bids }} bid(s) so far.
					{% ifequal listing.lister.username user.username%}
					Your bid is the current one.
					{% endifequal %}

				</span></p>

			<form action="{% url 'listing' listing.id %}" method='POST'>
				{% csrf_token %}
				<input type="hidden" name="listing_id" value={{ listing.id }}>
					{{ form }}
					<input type="submit" value="Place bid" class="btn btn-primary">
			</form>
		</div>
		</div>
	<h4>Details:</h4>
	<ul>
		<li>Listed by: {{ listing.lister }}</li>
		<li>Category: {{ listing.category|default_if_none:"Uncategorized" }}</li>
	</ul>
</div>

{% endblock %}